# MCP Rosreestr

MCP Server для работы с данными Росреестра - получение координат и информации об объектах недвижимости по кадастровому номеру.

Использует [rosreestr2coord](https://github.com/rendrom/rosreestr2coord) и API НСПД (https://nspd.gov.ru).

## Возможности

- **get_cadastral_coordinates** - получить данные объекта по кадастровому номеру
- **batch_get_cadastral_coordinates** - пакетное получение данных
- **check_ip_location** - проверка геолокации (диагностика)

## Поддерживаемые типы объектов

| Код | Тип объекта |
|-----|-------------|
| 1 | Объекты недвижимости (ЗУ, здания, ОКС, ОНС) |
| 2 | Кадастровое деление (округа, районы, кварталы) |
| 4 | Административно-территориальное деление |
| 5 | Зоны и территории (ОКН, ЗОУИТ, ООПТ) |
| 7 | Территориальные зоны |
| 15 | Комплексы объектов (ЕНК, предприятия) |

## Возвращаемые данные

- Кадастровый номер и адрес
- Площадь и статус
- Кадастровая стоимость
- Характеристики здания (этажность, материал стен, год постройки)
- Права и обременения
- GeoJSON геометрия
- Центр объекта (координаты)

## Установка

### 1. Клонировать репозиторий

```bash
git clone https://github.com/yasg1988/mcp-rosreestr.git
cd mcp-rosreestr
```

### 2. Установить зависимости

```bash
pip install -r requirements.txt
```

Или через pyproject.toml:
```bash
pip install -e .
```

### 3. Настроить Claude Code

Добавьте в `.mcp.json` проекта или `~/.claude/settings.json`:

```json
{
  "mcpServers": {
    "rosreestr": {
      "command": "python",
      "args": ["/полный/путь/к/mcp-rosreestr/server.py"],
      "env": {
        "ROSREESTR_API_URL": "https://your-api-url.com",
        "ROSREESTR_API_TOKEN": "your-api-token"
      }
    }
  }
}
```

**Важно:** укажите полный путь к `server.py` (например, `C:/Projects/mcp-rosreestr/server.py` или `/home/user/mcp-rosreestr/server.py`).

## Переменные окружения

| Переменная | Описание | Обязательно |
|------------|----------|-------------|
| `ROSREESTR_API_URL` | URL API сервера | Нет (есть дефолт) |
| `ROSREESTR_API_TOKEN` | Токен авторизации | Да |

## Примеры использования

### Получение данных об объекте

```
Получи информацию по кадастровому номеру 12:05:0402002:390
```

### Получение данных о кадастровом квартале

```
Получи статистику по кадастровому кварталу 12:05:0402002 (area_type=2)
```

### Пакетный запрос

```
Получи координаты участков: 12:05:0101001:1, 12:05:0101001:2, 12:05:0101001:3
```

## Особенности

- Автоматическое определение геолокации IP
- Из РФ: прямой запрос к НСПД через rosreestr2coord
- Из-за рубежа: запрос через API-прокси
- Возврат данных в формате GeoJSON
- Кэширование на стороне API (TTL 1 час)

## API Server

Для работы из-за пределов РФ требуется API-сервер с российским IP.
См. [rosreestr2coord-api](https://github.com/yasg1988/rosreestr2coord-api).

## Лицензия

MIT
